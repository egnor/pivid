#!/usr/bin/env python3
# Converts tables copy-and-pasted from CTA-861-G into coherent C++ data.
# https://members.cta.tech/ctaPublicationDetails/?id=11016f33-3422-e811-90ce-0003ff528c1a
# https://web.archive.org/web/20171201033424/https://standards.cta.tech/kwspub/published_docs/CTA-861-G_FINAL_revised_2017.pdf

import dataclasses
import typing

# Table 1 Video Format Timings--Detailed Timing Information
TABLE_1 = """
60,65 1280 720 Prog 3300 2020 750 30 18.000 24.0003 59.400
61,66 1280 720 Prog 3960 2680 750 30 18.750 25.000 74.250
62,67 1280 720 Prog 3300 2020 750 30 22.500 30.0003 74.250
108,109 1280 720 Prog 2500 1220 750 30 36.000 48.0003 90.000
32,72 1920 1080 Prog 2750 830 1125 45 27.000 24.0003 74.250
33,73 1920 1080 Prog 2640 720 1125 45 28.125 25.000 74.250
34,74 1920 1080 Prog 2200 280 1125 45 33.750 30.0003 74.250
111,112 1920 1080 Prog 2750 830 1125 45 54.000 48.0003 148.500
79 1680 720 Prog 3300 1620 750 30 18.000 24.0003 59.400
80 1680 720 Prog 3168 1488 750 30 18.750 25.000 59.400
81 1680 720 Prog 2640 960 750 30 22.500 30.0003 59.400
110 1680 720 Prog 2750 1070 750 30 36.000 48.0003 99.000
86 2560 1080 Prog 3750 1190 1100 20 26.400 24.0003 99.000
87 2560 1080 Prog 3200 640 1125 45 28.125 25.000 90.000
88 2560 1080 Prog 3520 960 1125 45 33.750 30.0003 118.800
113 2560 1080 Prog 3750 1190 1100 20 52.800 48.0003 198.000
93,103 3840 2160 Prog 5500 1660 2250 90 54.000 24.0003 297.000
94,104 3840 2160 Prog 5280 1440 2250 90 56.250 25.000 297.000
95,105 3840 2160 Prog 4400 560 2250 90 67.500 30.0003 297.000
114,116 3840 2160 Prog 5500 1660 2250 90 108.000 48.0003 594.000
98 4096 2160 Prog 5500 1404 2250 90 54.000 24.0003 297.000
99 4096 2160 Prog 5280 1184 2250 90 56.250 25.000 297.000
100 4096 2160 Prog 4400 304 2250 90 67.500 30.0003 297.000
115 4096 2160 Prog 5500 1404 2250 90 108.000 48.0003 594.000
121 5120 2160 Prog 7500 2380 2200 40 52.800 24.0003 396.000
122 5120 2160 Prog 7200 2080 2200 40 55.000 25.000 396.000
123 5120 2160 Prog 6000 880 2200 40 66.000 30.0003 396.000
124 5120 2160 Prog 6250 1130 2475 315 118.800 48.0003 742.500
194,202 7680 4320 Prog 11000 3320 4500 180 108.000 24.0003 1188.000
195,203 7680 4320 Prog 10800 3120 4400 80 110.000 25.000 1188.000
196,204 7680 4320 Prog 9000 1320 4400 80 132.000 30.0003 1188.000
197,205 7680 4320 Prog 11000 3320 4500 180 216.000 48.0003 2376.000
210 10240 4320 Prog 12500 2260 4950 630 118.800 24.0003 1485.000
211 10240 4320 Prog 13500 3260 4400 80 110.000 25.000 1485.000
212 10240 4320 Prog 11000 760 4500 180 135.000 30.0003 1485.000
213 10240 4320 Prog 12500 2260 4950 630 237.600 48.0003 2970.000

17,18 720 576 Prog 864 144 625 49 31.250 50.000 27.000
19,68 1280 720 Prog 1980 700 750 30 37.500 50.000 74.250
20 1920 1080 Int 2640 720 1125 22.5 28.125 50.000 74.250
21,22 1440 576 Int 1728 288 625 24.5 15.625 50.000 27.000
23,24 1440 288 Prog 1728 288 312 24 15.625 50.080 27.000
23,24 1440 288 Prog 1728 288 313 25 15.625 49.920 27.000
23,24 1440 288 Prog 1728 288 314 26 15.625 49.761 27.000
25,26 2880 576 Int 3456 576 625 24.5 15.625 50.000 54.000
27,28 2880 288 Prog 3456 576 312 24 15.625 50.080 54.000
27,28 2880 288 Prog 3456 576 313 25 15.625 49.920 54.000
27,28 2880 288 Prog 3456 576 314 26 15.625 49.761 54.000
29,30 1440 576 Prog 1728 288 625 49 31.250 50.000 54.000
31,75 1920 1080 Prog 2640 720 1125 45 56.250 50.000 148.500
37,38 2880 576 Prog 3456 576 625 49 31.250 50.000 108.000
39 1920 1080 Int 2304 384 1250 85 31.250 50.000 72.000
82 1680 720 Prog 2200 520 750 30 37.500 50.000 82.500
89 2560 1080 Prog 3300 740 1125 45 56.250 50.000 185.625
96,106 3840 2160 Prog 5280 1440 2250 90 112.500 50.000 594.000
101 4096 2160 Prog 5280 1184 2250 90 112.500 50.000 594.000
125 5120 2160 Prog 6600 1480 2250 90 112.500 50.000 742.500
198,206 7680 4320 Prog 10800 3120 4400 80 220.000 50.000 2376.000
214 10240 4320 Prog 13500 3260 4400 80 220.000 50.000 2970.000

1 640 480 Prog 800 160 525 45 31.469 59.9403 25.175
2,3 720 480 Prog 858 138 525 45 31.469 59.9403 27.000
4,69 1280 720 Prog 1650 370 750 30 45.000 60.0003 74.250
5 1920 1080 Int 2200 280 1125 22.5 33.750 60.0003 74.250
6,7 1440 480 Int 1716 276 525 22.5 15.734 59.9403 27.000
8,9 1440 240 Prog 1716 276 262 22 15.734 60.0543 27.000
8,9 1440 240 Prog 1716 276 263 23 15.734 59.8263 27.000
10,11 2880 480 Int 3432 552 525 22.5 15.734 59.9403 54.000
12,13 2880 240 Prog 3432 552 262 22 15.734 60.0543 54.000
12,13 2880 240 Prog 3432 552 263 23 15.734 59.8263 54.000
14,15 1440 480 Prog 1716 276 525 45 31.469 59.9403 54.000
16,76 1920 1080 Prog 2200 280 1125 45 67.500 60.0003 148.500
35,36 2880 480 Prog 3432 552 525 45 31.469 59.9403 108.000
83 1680 720 Prog 2200 520 750 30 45.000 60.0003 99.000
90 2560 1080 Prog 3000 440 1100 20 66.000 60.0003 198.000
97,107 3840 2160 Prog 4400 560 2250 90 135.000 60.0003 594.000
102 4096 2160 Prog 4400 304 2250 90 135.000 60.0003 594.000
126 5120 2160 Prog 5500 380 2250 90 135.000 60.0003 742.500
199,207 7680 4320 Prog 9000 1320 4400 80 264.000 60.0003 2376.000
215 10240 4320 Prog 11000 760 4500 180 270.000 60.0003 2970.000

40 1920 1080 Int 2640 720 1125 22.5 56.250 100.00 148.500
41,70 1280 720 Prog 1980 700 750 30 75.000 100.00 148.500
42,43 720 576 Prog 864 144 625 49 62.500 100.00 54.000
44,45 1440 576 Int 1728 288 625 24.5 31.250 100.00 54.000
64,77 1920 1080 Prog 2640 720 1125 45 112.500 100.00 297.000
84 1680 720 Prog 2000 320 825 105 82.500 100.00 165.000
91 2560 1080 Prog 2970 410 1250 170 125.000 100.00 371.250
117,119 3840 2160 Prog 5280 1440 2250 90 225.000 100.00 1188.000
127 5120 2160 Prog 6600 1480 2250 90 225.000 100.00 1485.000
200,208 7680 4320 Prog 10560 2880 4500 180 450.000 100.00 4752.000
216 10240 4320 Prog 13200 2960 4500 180 450.000 100.00 5940.000
218 4096 2160 Prog 5280 1184 2250 90 225.000 100.00 1188.000

46 1920 1080 Int 2200 280 1125 22.5 67.500 120.003 148.500
47,71 1280 720 Prog 1650 370 750 30 90.000 120.003 148.500
48,49 720 480 Prog 858 138 525 45 62.937 119.883 54.000
50,51 1440 480 Int 1716 276 525 22.5 31.469 119.883 54.000
63,78 1920 1080 Prog 2200 280 1125 45 135.000 120.003 297.000
85 1680 720 Prog 2000 320 825 105 99.000 120.003 198.000
92 2560 1080 Prog 3300 740 1250 170 150.000 120.003 495.000
118,120 3840 2160 Prog 4400 560 2250 90 270.000 120.003 1188.000
193 5120 2160 Prog 5500 380 2250 90 270.000 120.003 1485.000
201,209 7680 4320 Prog 8800 1120 4500 180 540.000 120.003 4752.000
217 10240 4320 Prog 11000 760 4500 180 540.000 120.003 5940.000
219 4096 2160 Prog 4400 304 2250 90 270.000 120.003 1188.000

52,53 720 576 Prog 864 144 625 49 125.000 200.00 108.00
54,55 1440 576 Int 1728 288 625 24.5 62.500 200.00 108.00

56,57 720 480 Prog 858 138 525 45 125.874 239.763 108.000
58,59 1440 480 Int 1716 276 525 22.5 62.937 239.763 108.000
"""

# Table 2 Video Format Timings--Detailed Sync Information
TABLE_2 = """
60,65 2 1760 40 220 P 5 5 20 P 1 SMPTE 296M [61] 1,2,25
61,66 2 2420 40 220 P 5 5 20 P 1 SMPTE 296M [61] 1,2
62,67 2 1760 40 220 P 5 5 20 P 1 SMPTE 296M [61] 1,2
108,109 2 960 40 220 P 5 5 20 P 1 SMPTE 296M [61] 1,2,25
32,72 2 638 44 148 P 4 5 36 P 1 SMPTE 274M [2] 14
33,73 2 528 44 148 P 4 5 36 P 1 SMPTE 274M [2] 14
34,74 2 88 44 148 P 4 5 36 P 1 SMPTE 274M [2] 14
111,112 2 638 44 148 P 4 5 36 P 1 SMPTE 274M [2] 14
79 2 1360 40 220 P 5 5 20 P 1 SMPTE 296M [61] 26
80 2 1228 40 220 P 5 5 20 P 1 SMPTE 296M [61] 26
81 2 700 40 220 P 5 5 20 P 1 SMPTE 296M [61] 26
110 2 810 40 220 P 5 5 20 P 1 SMPTE 296M [61] 26
86 2 998 44 148 P 4 5 11 P 1 SMPTE 274M [2] 27
87 2 448 44 148 P 4 5 36 P 1 SMPTE 274M [2] 27
88 2 768 44 148 P 4 5 36 P 1 SMPTE 274M [2] 27
113 2 998 44 148 P 4 5 11 P 1 SMPTE 274M [2] 27
93,103 2 1276 88 296 P 8 10 72 P 1 SMPTE 274M [2] 1,2,29
94,104 2 1056 88 296 P 8 10 72 P 1 SMPTE 274M [2] 1,2,29
95,105 2 176 88 296 P 8 10 72 P 1 SMPTE 274M [2] 1,2,29
114,116 2 1276 88 296 P 8 10 72 P 1 SMPTE 274M [2] 1,2,29
98 2 1020 88 296 P 8 10 72 P 1 SMPTE 274M [2] 1,2,30
99 2 968 88 128 P 8 10 72 P 1 SMPTE 274M [2] 1,2,30
100 2 88 88 128 P 8 10 72 P 1 SMPTE 274M [2] 1,2,30
115 2 1020 88 296 P 8 10 72 P 1 SMPTE 274M [2] 1,2,30
121 2 1996 88 296 P 8 10 22 P 1 SMPTE 274M [2] 31
122 2 1696 88 296 P 8 10 22 P 1 SMPTE 274M [2] 31
123 2 664 88 128 P 8 10 22 P 1 SMPTE 274M [2] 31
124 2 746 88 296 P 8 10 297 P 1 SMPTE 274M [2] 31
194,202 2 2552 176 592 P 16 20 144 P 1 SMPTE 274M [2]
195,203 2 2352 176 592 P 16 20 44 P 1 SMPTE 274M [2]
196,204 2 552 176 592 P 16 20 44 P 1 SMPTE 274M [2]
197,205 2 2552 176 592 P 16 20 144 P 1 SMPTE 274M [2]
210 2 1492 176 592 P 16 20 594 P 1 SMPTE 274M [2] 32
211 2 2492 176 592 P 16 20 44 P 1 SMPTE 274M [2] 32
212 2 288 176 296 P 16 20 144 P 1 SMPTE 274M [2] 32
213 2 1492 176 592 P 16 20 594 P 1 SMPTE 274M [2] 32

17,18 1 12 64 68 N 5 5 39 N 1 ITU-R BT.1358 [77]
19,68 2 440 40 220 P 5 5 20 P 1 SMPTE 296M [61] 1,2
20 4 528 44 148 P 2 5 15 P 1 SMPTE 274M [2] 1,2
21,22 3 24 126 138 N 2 3 19 N 1 ITU-R BT.656 [75] 6,15
23,24 1 24 126 138 N 2 3 19 N 1 ITU-R BT.1358 [77] 7,14,15,19
23,24 1 24 126 138 N 3 3 19 N 1 ITU-R BT.1358 [77] 7,14,15,19
23,24 1 24 126 138 N 4 3 19 N 1 ITU-R BT.1358 [77] 7,14,15,19
25,26 3 48 252 276 N 2 3 19 N 1 ITU-R BT.656 [75] 8,13,14
27,28 1 48 252 276 N 2 3 19 N 1 ITU-R BT.656 [75] 7,8,12,13,19
27,28 1 48 252 276 N 3 3 19 N 1 ITU-R BT.656 [75] 7,8,12,13,19
27,28 1 48 252 276 N 4 3 19 N 1 ITU-R BT.656 [75] 7,8,12,13,19
29,30 1 24 128 136 N 5 5 39 N 1 ITU-R BT.1358 [77] 9,10,14
31,75 2 528 44 148 P 4 5 36 P 1 SMPTE 274M [2] 14
37,38 1 48 256 272 N 5 5 39 N 1 ITU-R BT.1358 [77] 9,11
39 5 32 168 184 P 23 5 57 N 1 AS 4933.1-2005 [88] 5
82 2 260 40 220 P 5 5 20 P 1 SMPTE 296M [61] 1,2,26
89 2 548 44 148 P 4 5 36 P 1 SMPTE 274M [2] 14,27
96,106 2 1056 88 296 P 8 10 72 P 1 SMPTE 274M [2] 1,2,29
101 2 968 88 128 P 8 10 72 P 1 SMPTE 274M [2] 1,2,30
125 2 1096 88 296 P 8 10 72 P 1 SMPTE 274M [2] 31
198,206 2 2352 176 592 P 16 20 44 P 1 SMPTE 274M [2]
214 2 2492 176 592 P 16 20 44 P 1 SMPTE 274M [2] 32

1 1 16 96 48 N 10 2 33 N 1 VESA DMT [86] 3,4
2,3 1 16 62 60 N 9 6 30 N 7 CTA-770.2 [30] 2
4,69 2 110 40 220 P 5 5 20 P 1 CTA-770.3 [31] 1,2
5 4 88 44 148 P 2 5 15 P 1 CTA-770.3 [31] 1,2
6,7 3 38 124 114 N 4 3 15 N 4 CTA-770.2 [30] 2,15
8,9 1 38 124 114 N 4 3 15 N 4 CTA-770.2 [30] 7,14,15,19
8,9 1 38 124 114 N 5 3 15 N 4 CTA-770.2 [30] 7,14,15,19
10,11 3 76 248 228 N 4 3 15 N 4 CTA-770.2 [30] 8,13
12,13 1 76 248 228 N 4 3 15 N 4 CTA-770.2 [30] 7,8,13,19
12,13 1 76 248 228 N 5 3 15 N 4 CTA-770.2 [30] 7,8,13,19
14,15 1 32 124 120 N 9 6 30 N 7 CTA-770.2 [30] 9,10,13,14
16,76 2 88 44 148 P 4 5 36 P 1 SMPTE 274M [2] 14
35,36 1 64 248 240 N 9 6 30 N 7 CTA-770.2 [30] 9,11
83 2 260 40 220 P 5 5 20 P 1 CTA-770.3[31] 1,2,26
90 2 248 44 148 P 4 5 11 P 1 SMPTE 274M [2] 14,27
97,107 2 176 88 296 P 8 10 72 P 1 SMPTE 274M [2] 1,2,29
102 2 88 88 128 P 8 10 72 P 1 SMPTE 274M [2] 1,2,30
126 2 164 88 128 P 8 10 72 P 1 SMPTE 274M [2] 31
199,207 2 552 176 592 P 16 20 44 P 1 SMPTE 274M [2]
215 2 288 176 296 P 16 20 144 P 1 SMPTE 274M [2] 32

40 4 528 44 148 P 2 5 15 P 1 SMPTE 274M [2]
41,70 2 440 40 220 P 5 5 20 P 1 SMPTE 296M [61]
42,43 1 12 64 68 N 5 5 39 N 1 ITU-R BT.1358 [77]
44,45 3 24 126 138 N 2 3 19 N 1 ITU-R BT.656 [75] 16
64,77 2 528 44 148 P 4 5 36 P 1 SMPTE 274M [2]
84 2 60 40 220 P 5 5 95 P 1 SMPTE 296M [61] 26
91 2 218 44 148 P 4 5 161 P 1 SMPTE 274M [2] 27
117,119 2 1056 88 296 P 8 10 72 P 1 SMPTE 274M [2]
127 2 1096 88 296 P 8 10 72 P 1 SMPTE 274M [2] 31
200,208 2 2112 176 592 P 16 20 144 P 1 SMPTE 274M [2]
216 2 2192 176 592 P 16 20 144 P 1 SMPTE 274M [2] 32
218 2 800 88 296 P 8 10 72 P 1 SMPTE 274M [2]
46 4 88 44 148 P 2 5 15 P 1 SMPTE 274M [2]
47,71 2 110 40 220 P 5 5 20 P 1 SMPTE 296M [61]
48,49 1 16 62 60 N 9 6 30 N 7 CTA-770.2 [30]
50,51 3 38 124 114 N 4 3 15 N 4 CTA-770.2 [30] 16
63,78 2 88 44 148 P 4 5 36 P 1 SMPTE 274M [2]
85 2 60 40 220 P 5 5 95 P 1 SMPTE 296M [61] 26
92 2 548 44 148 P 4 5 161 P 1 SMPTE 274M [2] 27
118,120 2 176 88 296 P 8 10 72 P 1 SMPTE 274M [2]
193 2 164 88 128 P 8 10 72 P 1 SMPTE 274M [2] 31
201,209 2 352 176 592 P 16 20 144 P 1 SMPTE 274M [2]
217 2 288 176 296 P 16 20 144 P 1 SMPTE 274M [2] 32
219 2 88 88 128 P 8 10 72 P 1 SMPTE 274M [2]
52,53 1 12 64 68 N 5 5 39 N 1 ITU-R BT.1358 [77]
54,55 3 24 126 138 N 2 3 19 N 1 ITU-R BT.656 [75] 16
56,57 1 16 62 60 N 9 6 30 N 7 CTA-770.2 [30]
58,59 3 38 124 114 N 4 3 15 N 4 CTA-770.2 [30] 16
"""

# Table 3 Video Formats--Video ID Code and Aspect Ratios
TABLE_3 = """
1 640x480p 59.94Hz/60Hz 4:3 1:1
2 720x480p 59.94Hz/60Hz 4:3 8:9
3 720x480p 59.94Hz/60Hz 16:9 32:27
4 1280x720p 59.94Hz/60Hz 16:9 1:1
5 1920x1080i 59.94Hz/60Hz 16:9 1:1
6 720(1440)x480i 59.94Hz/60Hz 4:3 8:9
7 720(1440)x480i 59.94Hz/60Hz 16:9 32:27
8 720(1440)x240p 59.94Hz/60Hz 4:3 4:9
9 720(1440)x240p 59.94Hz/60Hz 16:9 16:27
10 2880x480i 59.94Hz/60Hz 4:3 2:9 – 20:9
11 2880x480i 59.94Hz/60Hz 16:9 8:27 -80:27
12 2880x240p 59.94Hz/60Hz 4:3 1:9 – 10:9
13 2880x240p 59.94Hz/60Hz 16:9 4:27 – 40:27
14 1440x480p 59.94Hz/60Hz 4:3 4:9 or 8:9
15 1440x480p 59.94Hz/60Hz 16:9 16:27 or 32:27
16 1920x1080p 59.94Hz/60Hz 16:9 1:1
17 720x576p 50Hz 4:3 16:15
18 720x576p 50Hz 16:9 64:45
19 1280x720p 50Hz 16:9 1:1
20 1920x1080i 50Hz 16:9 1:1
21 720(1440)x576i 50Hz 4:3 16:15
22 720(1440)x576i 50Hz 16:9 64:45
23 720(1440)x288p 50Hz 4:3 8:15
24 720(1440)x288p 50Hz 16:9 32:45
25 2880x576i 50Hz 4:3 2:15 – 20:15
26 2880x576i 50Hz 16:9 16:45-160:45
27 2880x288p 50Hz 4:3 1:15 – 10:15
28 2880x288p 50Hz 16:9 8:45 – 80:45
29 1440x576p 50Hz 4:3 8:15 or 16:15
30 1440x576p 50Hz 16:9 32:45 or 64:45
31 1920x1080p 50Hz 16:9 1:1
32 1920x1080p 23.98Hz/24Hz 16:9 1:1
33 1920x1080p 25Hz 16:9 1:1
34 1920x1080p 29.97Hz/30Hz 16:9 1:1
35 2880x480p 59.94Hz/60Hz 4:3 2:9,4:9,or 8:9
36 2880x480p 59.94Hz/60Hz 16:9 8:27,16:27,or 32:27
37 2880x576p 50Hz 4:3 4:15,8:15,or 16:15
38 2880x576p 50Hz 16:9 16:45,32:45,or 64:45
39 1920x1080i 50Hz 16:9 1:1
40 1920x1080i 100Hz 16:9 1:1
41 1280x720p 100Hz 16:9 1:1
42 720x576p 100Hz 4:3 16:15
43 720x576p 100Hz 16:9 64:45
44 720(1440)x576i 100Hz 4:3 16:15
45 720(1440)x576i 100Hz 16:9 64:45
46 1920x1080i 119.88/120Hz 16:9 1:1
47 1280x720p 119.88/120Hz 16:9 1:1
48 720x480p 119.88/120Hz 4:3 8:9
49 720x480p 119.88/120Hz 16:9 32:27
50 720(1440)x480i 119.88/120Hz 4:3 8:9
51 720(1440)x480i 119.88/120Hz 16:9 32:27
52 720x576p 200Hz 4:3 16:15
53 720x576p 200Hz 16:9 64:45
54 720(1440)x576i 200Hz 4:3 16:15
55 720(1440)x576i 200Hz 16:9 64:45
56 720x480p 239.76/240Hz 4:3 8:9
57 720x480p 239.76/240Hz 16:9 32:27
58 720(1440)x480i 239.76/240Hz 4:3 8:9
59 720(1440)x480i 239.76/240Hz 16:9 32:27
60 1280x720p 23.98Hz/24Hz 16:9 1:1
61 1280x720p 25Hz 16:9 1:1
62 1280x720p 29.97Hz/30Hz 16:9 1:1
63 1920x1080p 119.88/120Hz 16:9 1:1
64 1920x1080p 100Hz 16:9 1:1
65 1280x720p 23.98Hz/24Hz 64:27 4:3
66 1280x720p 25Hz 64:27 4:3
67 1280x720p 29.97Hz/30Hz 64:27 4:3
68 1280x720p 50Hz 64:27 4:3
69 1280x720p 59.94Hz/60Hz 64:27 4:3
70 1280x720p 100Hz 64:27 4:3
71 1280x720p 119.88/120Hz 64:27 4:3
72 1920x1080p 23.98Hz/24Hz 64:27 4:3
73 1920x1080p 25Hz 64:27 4:3
74 1920x1080p 29.97Hz/30Hz 64:27 4:3
75 1920x1080p 50Hz 64:27 4:3
76 1920x1080p 59.94Hz/60Hz 64:27 4:3
77 1920x1080p 100Hz 64:27 4:3
78 1920x1080p 119.88/120Hz 64:27 4:3
79 1680x720p 23.98Hz/24Hz 64:27 64:63
80 1680x720p 25Hz 64:27 64:63
81 1680x720p 29.97Hz/30Hz 64:27 64:63
82 1680x720p 50Hz 64:27 64:63
83 1680x720p 59.94Hz/60Hz 64:27 64:63
84 1680x720p 100Hz 64:27 64:63
85 1680x720p 119.88/120Hz 64:27 64:63
86 2560x1080p 23.98Hz/24Hz 64:27 1:1
87 2560x1080p 25Hz 64:27 1:1
88 2560x1080p 29.97Hz/30Hz 64:27 1:1
89 2560x1080p 50Hz 64:27 1:1
90 2560x1080p 59.94Hz/60Hz 64:27 1:1
91 2560x1080p 100Hz 64:27 1:1
92 2560x1080p 119.88/120Hz 64:27 1:1
93 3840x2160p 23.98Hz/24Hz 16:9 1:1
94 3840x2160p 25Hz 16:9 1:1
95 3840x2160p 29.97Hz/30Hz 16:9 1:1
96 3840x2160p 50Hz 16:9 1:1
97 3840x2160p 59.94Hz/60Hz 16:9 1:1
98 4096x2160p 23.98Hz/24Hz 256:135 1:1
99 4096x2160p 25Hz 256:135 1:1
100 4096x2160p 29.97Hz/30Hz 256:135 1:1
101 4096x2160p 50Hz 256:135 1:1
102 4096x2160p 59.94Hz/60Hz 256:135 1:1
103 3840x2160p 23.98Hz/24Hz 64:27 4:3
104 3840x2160p 25Hz 64:27 4:3
105 3840x2160p 29.97Hz/30Hz 64:27 4:3
106 3840x2160p 50Hz 64:27 4:3
107 3840x2160p 59.94Hz/60Hz 64:27 4:3
108 1280x720p 47.95Hz/48Hz 16:9 1:1
109 1280x720p 47.95Hz/48Hz 64:27 4:3
110 1680x720p 47.95Hz/48Hz 64:27 64:63
111 1920x1080p 47.95Hz/48Hz 16:9 1:1
112 1920x1080p 47.95Hz/48Hz 64:27 4:3
113 2560x1080p 47.95Hz/48Hz 64:27 1:1
114 3840x2160p 47.95Hz/48Hz 16:9 1:1
115 4096x2160p 47.95Hz/48Hz 256:135 1:1
116 3840x2160p 47.95Hz/48Hz 64:27 4:3
117 3840x2160p 100Hz 16:9 1:1
118 3840x2160p 119.88/120Hz 16:9 1:1
119 3840x2160p 100Hz 64:27 4:3
120 3840x2160p 119.88/120Hz 64:27 4:3
121 5120x2160p 23.98Hz/24Hz 64:27 1:1
122 5120x2160p 25Hz 64:27 1:1
123 5120x2160p 29.97Hz/30Hz 64:27 1:1
124 5120x2160p 47.95Hz/48Hz 64:27 1:1
125 5120x2160p 50Hz 64:27 1:1
126 5120x2160p 59.94Hz/60Hz 64:27 1:1
127 5120x2160p 100Hz 64:27 1:1
128-192 Forbidden
193 5120x2160p 119.88/120Hz 64:27 1:1
194 7680x4320p 23.98Hz/24Hz 16:9 1:1
195 7680x4320p 25Hz 16:9 1:1
196 7680x4320p 29.97Hz/30Hz 16:9 1:1
197 7680x4320p 47.95Hz/48Hz 16:9 1:1
198 7680x4320p 50Hz 16:9 1:1
199 7680x4320p 59.94Hz/60Hz 16:9 1:1
200 7680x4320p 100Hz 16:9 1:1
201 7680x4320p 119.88/120Hz 16:9 1:1
202 7680x4320p 23.98Hz/24Hz 64:27 4:3
203 7680x4320p 25Hz 64:27 4:3
204 7680x4320p 29.97Hz/30Hz 64:27 4:3
205 7680x4320p 47.95Hz/48Hz 64:27 4:3
206 7680x4320p 50Hz 64:27 4:3
207 7680x4320p 59.94Hz/60Hz 64:27 4:3
208 7680x4320p 100Hz 64:27 4:3
209 7680x4320p 119.88/120Hz 64:27 4:3
210 10240x4320p 23.98Hz/24Hz 64:27 1:1
211 10240x4320p 25Hz 64:27 1:1
212 10240x4320p 29.97Hz/30Hz 64:27 1:1
213 10240x4320p 47.95Hz/48Hz 64:27 1:1
214 10240x4320p 50Hz 64:27 1:1
215 10240x4320p 59.94Hz/60Hz 64:27 1:1
216 10240x4320p 100Hz 64:27 1:1
217 10240x4320p 119.88/120Hz 64:27 1:1
218 4096x2160p 100Hz 256:135 1:1
219 4096x2160p 119.88/120Hz 256:135 1:1
220-255 Reserved for the Future
0 No Video Identification Code Available (Used with AVI InfoFrame only)
"""

@dataclasses.dataclass
class DisplayMode:
    """Combined mode data, parallel to C++ DisplayMode (display_output.h)."""

    size: typing.Tuple[int, int] = (0, 0)
    scan_size: typing.Tuple[int, int] = (0, 0)
    sync_start: typing.Tuple[int, int] = (0, 0)
    sync_end: typing.Tuple[int, int] = (0, 0)
    sync_polarity: typing.Tuple[int, int] = (0, 0)
    doubling: typing.Tuple[int, int] = (0, 0)
    aspect: typing.Tuple[int, int] = (0, 0)
    pixel_khz: int = 0
    nominal_hz: int = 0

vic_mode = {}

for line in TABLE_1.split("\n"):
    line = line.strip()
    if not line: continue

    # Example: 60,65 1280 720 Prog 3300 2020 750 30 18.000 24.0003 59.400
    fields = line.split()
    for vic in fields[0].split(","):
        vic = int(vic)
        mode = vic_mode.setdefault(vic, DisplayMode())
        mode.size = (int(fields[1]), int(fields[2]))
        mode.scan_size = (int(fields[4]), int(fields[6]))
        mode.doubling = (0, {"Prog": 0, "Int": -1}[fields[3]])
        mode.pixel_khz = int(float(fields[10]) * 1e3)
        mode.nominal_hz = int(round(float(fields[9])))

        i_double = 2 ** -mode.doubling[1]
        assert mode.scan_size[0] == mode.size[0] + int(fields[5])
        assert mode.scan_size[1] == mode.size[1] + float(fields[7]) * i_double

        assert abs(mode.pixel_khz / mode.scan_size[0] - float(fields[8])) < 1e-3
        assert abs(
            mode.pixel_khz * 1e3 / mode.scan_size[0] / mode.scan_size[1] -
            float(fields[9]) / i_double
        ) < 1e-2

for line in TABLE_2.split("\n"):
    line = line.strip()
    if not line: continue

    # Example: 60,65 2 1760 40 220 P 5 5 20 P 1 SMPTE 296M [61] 1,2,25
    fields = line.split()
    for vic in fields[0].split(","):
        vic = int(vic)
        mode = vic_mode[vic]

        i_double = 2 ** -mode.doubling[1]
        mode.sync_start = (
            mode.size[0] + int(fields[2]),
            mode.size[1] + int(fields[6]) * i_double
        )
        mode.sync_end = (
            mode.sync_start[0] + int(fields[3]),
            mode.sync_start[1] + int(fields[7]) * i_double
        )
        mode.sync_polarity = (
            {"P": +1, "N": -1}[fields[5]],
            {"P": +1, "N": -1}[fields[9]]
        )

        assert mode.scan_size[0] == mode.sync_end[0] + int(fields[4])
        assert 0 <= (
            mode.scan_size[1] - (mode.sync_end[1] + int(fields[8]) * i_double)
        ) <= 2

for line in TABLE_3.split("\n"):
    line = line.strip()
    if not line: continue

    # Example: 1 640x480p 59.94Hz/60Hz 4:3 1:1
    fields = line.split()
    if fields[1] in ("Forbidden", "Reserved", "No"): continue
    vic = int(fields[0])
    mode = vic_mode[vic]

    aspect_h, aspect_v = fields[3].split(":")
    mode.aspect = (int(aspect_h), int(aspect_v))

    name = fields[1]
    assert name[-1:] == ("i" if mode.doubling[1] < 0 else "p")
    name_h, name_v = name[:-1].split("x")
    if "(" in name_h:
        name_h, name_x = name_h.split("(")
        name_x = name_x.strip(")")
    else:
        name_x = name_h

    name_x, name_h, name_v = int(name_x), int(name_h), int(name_v)
    assert (name_x, name_v) == mode.size
    if name_x != name_h:
        assert name_x == name_h * 2
        mode.size = (name_h, name_v)
        mode.doubling = (1, mode.doubling[1])
        mode.pixel_khz = mode.pixel_khz // 2
        for field in ("scan_size", "sync_start", "sync_end"):
            x, y = getattr(mode, field)
            setattr(mode, field, (x // 2, y))

    pix_field = " ".join(fields[4:])
    if " " not in pix_field and "-" not in pix_field and "," not in pix_field:
        pixel_h, pixel_v = pix_field.split(":")
        pixel_ratio = int(pixel_h) / int(pixel_v)
        exp = (mode.aspect[0] / mode.size[0]) / (mode.aspect[1] / mode.size[1])
        assert abs(pixel_ratio - exp) < 1e-3

print(vic_mode[10])
